<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>India Weather App</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
*{box-sizing:border-box;font-family:Poppins,sans-serif}

body{
  margin:0;
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  background:linear-gradient(135deg,#43cea2,#185a9d);
  transition:.4s;
}
body.dark{
  background:linear-gradient(135deg,#232526,#414345);
}

.container{
  width:100%;
  max-width:440px;
  background:rgba(255,255,255,.93);
  padding:22px;
  border-radius:18px;
  box-shadow:0 12px 30px rgba(0,0,0,.3);
  text-align:center;
}
body.dark .container{background:#1e1e1e;color:#eee}

.top{
  display:flex;
  justify-content:space-between;
  align-items:center;
}

input{
  width:100%;
  padding:12px;
  border-radius:8px;
  border:1px solid #ccc;
  margin-top:10px;
}

#suggestions{
  background:#fff;
  border-radius:8px;
  overflow:hidden;
}
body.dark #suggestions{background:#333}

.suggestion{
  padding:10px;
  cursor:pointer;
}
.suggestion:hover{background:#e0f2f1}

button{
  width:100%;
  margin-top:10px;
  padding:10px;
  border:none;
  border-radius:8px;
  background:#43cea2;
  color:#fff;
  cursor:pointer;
}

.weather-box{
  margin-top:15px;
  padding:15px;
  border-radius:15px;
  color:#fff;
  position:relative;
  overflow:hidden;
}

.forecast{
  display:flex;
  gap:8px;
  overflow-x:auto;
  margin-top:10px;
}
.forecast div{
  background:rgba(255,255,255,.25);
  padding:8px;
  border-radius:10px;
  min-width:80px;
  font-size:13px;
}

.go-back{background:#185a9d}

/* Animations */
.sunny::before{
  content:"â˜€ï¸";
  font-size:60px;
  position:absolute;
  top:-10px;
  right:10px;
  animation:spin 6s linear infinite;
}
@keyframes spin{from{transform:rotate(0)}to{transform:rotate(360deg)}}

.cool::before{
  content:"â˜ï¸";
  font-size:50px;
  position:absolute;
  top:10px;
  left:-60px;
  animation:cloud 8s linear infinite;
}
@keyframes cloud{from{left:-60px}to{left:100%}}

.rainy::after{
  content:"ğŸŒ§ï¸ ğŸŒ§ï¸ ğŸŒ§ï¸";
  position:absolute;
  bottom:10px;
  left:0;
  right:0;
  animation:rain 1s linear infinite;
}
@keyframes rain{from{opacity:.3}to{opacity:1}}
</style>
</head>

<body>

<div class="container">
  <div class="top">
    <h3 id="title">ğŸŒ¦ India Weather</h3>

<div>
  <select onchange="setLang(this.value)">
    <option value="en">English</option>
    <option value="te">à°¤à±†à°²à±à°—à±</option>
    <option value="hi">à¤¹à¤¿à¤¨à¥à¤¦à¥€</option>
  </select>
  ğŸŒ™ <span onclick="toggleDark()" style="cursor:pointer;"> </span>
</div>

  </div>

  <input id="cityInput" placeholder="Enter village or city">
  <div id="suggestions"></div>

  <button onclick="useMyLocation()">ğŸ“ Use My Location</button>
  <button onclick="toggleUnit()">ğŸŒ¡ Toggle Â°C / Â°F</button>

  <div id="weatherResult"></div>
</div>
<script>
/* ================= CONFIG ================= */
const API_KEY = "23f9683c6b122e966443699e580ebc83";
let unit = "metric";
let currentLang = localStorage.getItem("language") || "en";

/* Default village coordinates */
const DEFAULT_LAT = 16.5062;
const DEFAULT_LON = 80.6480;

/* ================= LANGUAGE TEXT ================= */
const translations = {
  en: {
    title: "ğŸŒ¦ India Weather",
    placeholder: "Enter village or city",
    locationBtn: "ğŸ“ Use My Location",
    toggleBtn: "ğŸŒ¡ Toggle Â°C / Â°F",
    back: "â¬… Go Back",
    yourLocation: "Your Location",
    defaultVillage: "Default Village"
  },
  te: {
    title: "ğŸŒ¦ à°­à°¾à°°à°¤ à°µà°¾à°¤à°¾à°µà°°à°£à°‚",
    placeholder: "à°—à±à°°à°¾à°®à°‚ à°²à±‡à°¦à°¾ à°¨à°—à°°à°‚ à°¨à°®à±‹à°¦à± à°šà±‡à°¯à°‚à°¡à°¿",
    locationBtn: "ğŸ“ à°¨à°¾ à°¸à±à°¥à°¾à°¨à°‚ à°‰à°ªà°¯à±‹à°—à°¿à°‚à°šà°‚à°¡à°¿",
    toggleBtn: "ğŸŒ¡ Â°C / Â°F à°®à°¾à°°à±à°šà±",
    back: "â¬… à°µà±†à°¨à°•à±à°•à°¿ à°µà±†à°³à±à°³à±",
    yourLocation: "à°®à±€ à°¸à±à°¥à°¾à°¨à°‚",
    defaultVillage: "à°¡à°¿à°«à°¾à°²à±à°Ÿà± à°—à±à°°à°¾à°®à°‚"
  },
  hi: {
    title: "ğŸŒ¦ à¤­à¤¾à¤°à¤¤ à¤®à¥Œà¤¸à¤®",
    placeholder: "à¤—à¤¾à¤‚à¤µ à¤¯à¤¾ à¤¶à¤¹à¤° à¤¦à¤°à¥à¤œ à¤•à¤°à¥‡à¤‚",
    locationBtn: "ğŸ“ à¤®à¥‡à¤°à¥€ à¤²à¥‹à¤•à¥‡à¤¶à¤¨ à¤‰à¤ªà¤¯à¥‹à¤— à¤•à¤°à¥‡à¤‚",
    toggleBtn: "ğŸŒ¡ Â°C / Â°F à¤¬à¤¦à¤²à¥‡à¤‚",
    back: "â¬… à¤µà¤¾à¤ªà¤¸ à¤œà¤¾à¤à¤‚",
    yourLocation: "à¤†à¤ªà¤•à¥€ à¤²à¥‹à¤•à¥‡à¤¶à¤¨",
    defaultVillage: "à¤¡à¤¿à¤«à¥‰à¤²à¥à¤Ÿ à¤—à¤¾à¤‚à¤µ"
  }
};

/* ================= SET LANGUAGE ================= */
function setLang(lang){
  currentLang = lang;
  localStorage.setItem("language", lang);
  applyLanguage();
}

function applyLanguage(){
  const t = translations[currentLang];
  document.getElementById("title").innerText = t.title;
  document.getElementById("cityInput").placeholder = t.placeholder;
  document.querySelectorAll("button")[0].innerText = t.locationBtn;
  document.querySelectorAll("button")[1].innerText = t.toggleBtn;
  document.querySelector("select").value = currentLang;
}

/* ================= WEATHER APP ================= */
class WeatherApp{
  constructor(){
    this.input = cityInput;
    this.suggestions = suggestions;
    this.result = weatherResult;
    this.input.addEventListener("input",()=>this.search());
    this.loadCache();
  }

  async search(){
    const q=this.input.value.trim();
    if(q.length<3){this.suggestions.innerHTML="";return;}

    const res=await fetch(
      `https://api.openweathermap.org/geo/1.0/direct?q=${q},IN&limit=5&appid=${API_KEY}`
    );
    const data=await res.json();
    this.showSuggestions(data.filter(d=>d.country==="IN"));
  }

  showSuggestions(list){
    this.suggestions.innerHTML="";
    list.forEach(p=>{
      const div=document.createElement("div");
      div.className="suggestion";
      div.innerText=`${p.name}, ${p.state||""}`;
      div.onclick=()=>{
        this.input.value="";
        this.suggestions.innerHTML="";
        this.getWeather(p.lat,p.lon,p.name);
      };
      this.suggestions.appendChild(div);
    });
  }

  async getWeather(lat,lon,name){
    const weather=await fetch(
      `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=${unit}&appid=${API_KEY}&lang=${currentLang}`
    ).then(r=>r.json());

    const forecast=await fetch(
      `https://api.openweathermap.org/data/2.5/forecast?lat=${lat}&lon=${lon}&units=${unit}&appid=${API_KEY}&lang=${currentLang}`
    ).then(r=>r.json());

    localStorage.setItem("weatherCache",
      JSON.stringify({weather,forecast,name})
    );

    this.display(weather,forecast,name);
  }

  display(w,f,name){
    let bg="#4fc3f7",cls="cool";

    if(w.weather[0].main.includes("Clear")){bg="#fbc02d";cls="sunny"}
    if(w.weather[0].main.includes("Cloud")){bg="#90a4ae";cls="cool"}
    if(w.weather[0].main.includes("Rain")){cls="rainy"}

    this.result.innerHTML=`
      <div class="weather-box ${cls}" style="background:${bg}">
        <h3>${name}, India</h3>
        <img src="https://openweathermap.org/img/wn/${w.weather[0].icon}@2x.png">
        <p>${w.main.temp}Â° ${unit==="metric"?"C":"F"}</p>
        <p>${w.weather[0].description}</p>

        <div class="forecast">
          ${f.list.filter((_,i)=>i%8===0).map(d=>`
            <div>
              ${new Date(d.dt_txt).toLocaleDateString("en-IN",{weekday:"short"})}<br>
              ${d.main.temp}Â°
            </div>
          `).join("")}
        </div>

        <button class="go-back" onclick="history.back()">
          ${translations[currentLang].back}
        </button>
      </div>
    `;
  }

  loadCache(){
    const c=localStorage.getItem("weatherCache");
    if(!c){
      this.getWeather(DEFAULT_LAT,DEFAULT_LON,
        translations[currentLang].defaultVillage);
      return;
    }
    const {weather,forecast,name}=JSON.parse(c);
    this.display(weather,forecast,name);
  }
}

/* ================= FUNCTIONS ================= */
const app=new WeatherApp();

function toggleDark(){
  document.body.classList.toggle("dark");
}

function toggleUnit(){
  unit=unit==="metric"?"imperial":"metric";
}

function useMyLocation(){
  navigator.geolocation.getCurrentPosition(p=>{
    app.getWeather(
      p.coords.latitude,
      p.coords.longitude,
      translations[currentLang].yourLocation
    );
  });
}

/* ===== Apply saved language on load ===== */
document.addEventListener("DOMContentLoaded", applyLanguage);
</script>


</body>
</html>
